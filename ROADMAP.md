# Дорожная карта развития Atlantis FastAPI

## Управление пользователями

### Клиенты и Студенты
- [x] Базовая модель клиента
- [x] CRUD операции для клиентов
- [x] Управление статусом клиента
- [x] Базовая модель студента
- [x] CRUD операции для студентов
- [x] Связь клиент-студент
- [x] Возможность клиенту быть студентом
- [x] Управление балансом клиента
- [ ] История операций с балансом
  > Логирование всех изменений баланса с указанием причины
- [ ] Система уведомлений о балансе
  > Уведомления о низком балансе и новых инвойсах

### Тренеры
- [x] Базовая модель тренера
- [x] CRUD операции
- [x] Расширенная валидация данных
  > Добавлена валидация телефона, email, имени, фамилии и зарплаты
- [x] Управление статусом тренера
  > Добавлена возможность деактивации с автоматическим отслеживанием даты
- [x] Тесты для тренеров
  > Добавлены тесты для валидации данных и управления статусом
- [ ] Права доступа
  > Разграничить права доступа между админом и тренером

## Финансы

### Платежи
- [ ] Модель платежа (Payment)
  > Создать модель для хранения информации о платежах
- [ ] Регистрация платежей тренерами/админами
  > Реализовать API для добавления платежей
- [ ] Автоматическое обновление баланса
  > При регистрации платежа автоматически обновлять баланс клиента
- [ ] История платежей клиента
  > Возможность просмотра всех платежей клиента

### Инвойсы
- [ ] Модель инвойса (Invoice)
  > Создать модель для хранения информации о начислениях
- [ ] Автоматическое создание инвойсов
  > Создание инвойсов при записи на тренировки
- [ ] Система автоматического погашения
  > Реализовать механизм автоматической оплаты инвойсов при пополнении баланса
- [ ] История инвойсов
  > Возможность просмотра всех инвойсов клиента с их статусами

## Тренировки

### Типы тренировок
- [x] Базовая модель типа тренировки
- [x] CRUD операции
- [ ] Расширенные атрибуты типа тренировки
  > Добавить поля: стоимость, требуется ли абонемент, стоимость пробного занятия
- [ ] Правила оплаты
  > Логика определения стоимости (обычная/пробная)

### Шаблоны тренировок (Фиксированное расписание)
- [x] Базовая модель шаблона
- [x] CRUD операции
- [x] **Проверка конфликтов тренеров** ✅ (Реализовано 2024-12-19)
  - [x] ✅ Добавлена валидация в `create_training_template()` для предотвращения двойного бронирования тренера
  - [x] ✅ Добавлена валидация в `update_training_template()` с исключением текущего шаблона
  - [x] ✅ Возвращается HTTP 400 с детальным сообщением "Trainer conflict" при конфликте
  - [x] ✅ Добавлены тесты `test_create_conflicting_templates_should_fail()` для проверки валидации
  - [x] ✅ Проверяется пересечение по времени: день недели + время начала тренировки
- [ ] Управление статусом шаблона
  > Добавить возможность временно деактивировать шаблон
- [ ] Связь с типом тренировки
  > Привязка правил оплаты и требований к тренировке

### Актуальные тренировки
- [ ] Базовая модель тренировки
  > Создать модель для разовых и актуальных тренировок
- [ ] Связь с типом тренировки
  > Наследование правил оплаты и требований
- [ ] Система записи на тренировки
  > Реализовать механизм записи с проверкой баланса и правил оплаты
- [ ] Управление статусом тренировки
  > Добавить статусы: запланирована, проведена, отменена
- [ ] Автоматическое создание инвойсов
  > При записи на тренировку создавать инвойс с учетом типа оплаты (обычная/пробная)
- [ ] Учет посещаемости
  > Отметки о посещении тренировок

## Общие улучшения

### Безопасность
- [x] Базовая аутентификация
- [x] Авторизация по ролям
- [ ] Права доступа для тренеров
  > Настройка прав на работу с платежами
- [ ] Аудит финансовых операций
  > Логирование всех операций с балансом и платежами

### API
- [ ] Документация на русском
  > Перевести документацию API на русский язык
- [ ] Примеры использования
  > Добавить примеры запросов и ответов
- [ ] Оптимизация запросов
  > Улучшить производительность запросов к БД

### Тестирование
- [x] Базовые тесты CRUD операций
- [ ] Тесты финансовых операций
  > Тестирование платежей и погашения инвойсов
- [ ] Тесты правил оплаты
  > Проверка логики определения стоимости тренировок
- [ ] Интеграционные тесты
  > Проверка взаимодействия компонентов
- [ ] Тесты безопасности
  > Проверка прав доступа и аудита

## Приоритеты разработки:

1. **Высокий приоритет**
   - Управление балансом клиента
   - Система платежей и инвойсов
   - Автоматическое погашение инвойсов
   - Расширенные атрибуты типа тренировки

2. **Средний приоритет**
   - История операций с балансом
   - Тесты финансовых операций
   - Документация на русском
   - Актуальные тренировки

3. **Низкий приоритет**
   - Система уведомлений
   - Аудит финансовых операций
   - Оптимизация запросов
   - Расширенная аналитика 




пофиксить датагрид добавить возможность перехождить на с раницы клиентов тренеров и учеников при клике на всю строку

панель тренера - тренировки
сколько тренировок за день за неделю и закалендарный месяц и год  провел тренер с фильтрами по датам
сколько рабочих днец за те же периоды
сколько выходных за те же периоды
приход за день неделю месяц год с фильтрами по датам
расход так же
сколько человек пропустили занятия
- продумать что за штрафную отмену деньгиттренеру идут не сразу а люба скажет 
- сумма за тренировку для тренера долдна устанавливаться админом, если у тренера не фикс оклад то надо указывать зп за тренировку и за вид тренировки
- в ui календаря добавить раздлеление цветом междц ячейками в светлой теме


